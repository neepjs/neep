/*!
 * Neep v0.1.0-alpha.16
 * (c) 2019-2021 Fierflame
 * @license MIT
 */
const e="0.1.0-alpha.16",t=!0;function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class r extends Error{constructor(e,t=""){super(t?`[${t}] ${e}`:e),n(this,"tag",void 0),this.tag=t}}function o(e,t,n){if(!e)throw new r(t,n)}let s;const i=Object.create(null);function c(e="",t=i.default){return"object"==typeof e?e:i[e]||t}let u,d,a,l,h,f,p,_,y,m,v,$,g,b,w,x,j,R;function C(e){var t,n;(t=e.monitorable)&&({printError:u,safeify:d,markRead:a,markChange:l,postpone:h,exec:f,monitor:p,value:_,computed:y,isValue:m,valueify:v,asValue:$,mixValue:g,defineProperty:b,createObject:w,get:x,set:j,encase:R}=t),(n=e.renderer)&&(i[n.type]=n,s||(i.default||(i.default=n),!s&&n.nextFrame&&(i.default=n,s=n.nextFrame.bind(n))))}const k="core:scopeslot",N="core:render",S="core:slot",D="core:container",T="template",A="template";function O(e,t){return!e||"function"!=typeof e&&"object"!=typeof e?t?function(e){const t=e?_(void 0):{value:void 0};function n(e,n,r,o){t.value=!1===o?r:void 0}return Reflect.defineProperty(n,"value",{get:()=>t.value,enumerable:!0,configurable:!0}),n}(e):function(e){const t=e?_(void 0):{value:void 0};function n(e){t.value=e}return Reflect.defineProperty(n,"value",{get:()=>t.value,enumerable:!0,configurable:!0}),n}(e):t?function(e){return function(t,n,r,o){!0!==o?!1===o&&e.delete(r):e.add(r)}}(e):function(e){return function(t,n){void 0!==t?void 0!==n?"function"!=typeof e.replace?(e.delete(n),e.add(t)):e.replace(t,n):e.add(t):void 0!==n&&e.delete(n)}}(e)}let E,P=!1,H=[],M=[];function q(e,t,n){if(o(E,`Function \`${e}\` can only be called within a cycle.`,"life"),P){const r=n(E);return M.push({name:e,lib:t,value:r}),r}const r=M.shift();return o(r&&r.name===e&&r.lib===t&&!r.list,""),r.value}function F(e,t,n){if(o(E,`Function \`${e}\` can only be called within a cycle.`,"life"),P){const r=[];M.push({name:e,lib:t,list:r});const o=M;M=r;try{return n(E)}finally{M=o}}const r=M.shift();o(r&&r.name===e&&r.lib===t&&r.list,"");const s=M,i=[...r.list];M=i;try{const e=n(E);return o(!i.length,""),e}finally{M=s}}function I(e,t,n){const r=E;E=e;const s=P;P=!e.created;const i=H;H=E.$_useHookValues;const c=M;M=P?H:[...H];try{const e=n();return o(P||!M.length,"Inconsistent number of useService executions","life"),e}finally{E=r,P=s,M=c,H=i}}function V(e,t=!1){return o(E,`Function \`${e}\` can only be called within a cycle.`,"life"),o(!t||!E.created,`Function \`${e}\` can only be called at initialization time.`,"life"),E}const L=Object.create(null);function z(e,t,n){let r=(null==n?void 0:n.$_hooks)||L;if(!r)return()=>{};t=d(t);let o=r[e];return o||(o=new Set,r[e]=o),o.add(t),()=>o.delete(t)}function B(e,t){if(t){for(const n of t.$_hooks[e]||[])n(t);for(const n of L[e]||[])n(t)}}function K(e,t,n){const r=V("watch");if("function"!=typeof e)return()=>{};let o;if(m(e))o=e.watch(t),t(e,!1);else{const n=y(e);o=n.watch((e,n)=>t(e(),n)),t(n(),!1)}return z("beforeDestroy",()=>o(),r),o}function W(e){return q("useValue","core","function"==typeof e?e:()=>_(void 0))}function U(e,...t){return q("useService","core",n=>e(n,...t))}function G(e,...t){return e(V("byService"),...t)}function J(e,t,n){const r=V("setHook");if(!n||!r.created)return z(e,()=>t(),r)}const Q=Symbol.for("renderer"),X=Symbol.for("name"),Y=Symbol.for("components"),Z=Symbol.for("props"),ee=Symbol.for("$$$componentValue$$$"),te=Symbol.for("$$$objectType$$$"),ne="$$$objectType$$$Element",re="$$$objectType$$$DeliverComponent",oe="$$$objectType$$$NativeComponentNode",se="$$$objectType$$$SimpleComponent",ie="$$$objectType$$$ShellComponent",ce="$$$objectType$$$RenderComponent",ue="$$$objectType$$$ContainerComponent",de="$$$objectType$$$ElementComponent",ae="$$$objectType$$$HookEntity",le="$$$objectType$$$RootEntity",he=Symbol.for("$$$deliverKey$$$"),fe=Symbol.for("$$$deliverDefault$$$");function pe(e){return"function"==typeof e&&"$$$objectType$$$SimpleComponent"===e[te]}function _e(e){return"function"==typeof e&&"$$$objectType$$$ShellComponent"===e[te]}function ye(e){return"function"==typeof e&&"$$$objectType$$$NativeComponentNode"===e[te]}function me(e){return"function"==typeof e&&"$$$objectType$$$RenderComponent"===e[te]}function ve(e){return"function"==typeof e&&"$$$objectType$$$ContainerComponent"===e[te]}function $e(e){return"function"==typeof e&&"$$$objectType$$$ElementComponent"===e[te]}function ge(e){return"function"==typeof e&&"$$$objectType$$$DeliverComponent"===e[te]}function be(e){return!!e&&("object"==typeof e&&"$$$objectType$$$Element"===e[te])}function we(e){if(!be(e))return!1;const{tag:t}=e;return"string"==typeof t&&"template"===t.toLowerCase()}function xe(e){if(!be(e))return!1;const{tag:t}=e;return"string"==typeof t&&t.toLowerCase()===N}function je(e){return be(e)&&pe(e.tag)}function Re(e,t,...n){const r=t?{...t}:{},o={};for(const e of Object.keys(r))if("@"!==e)if("!"!==e[0])if("@"!==e[0])if("n-"!==e.substr(0,2))if("on-"!==e.substr(0,3))if("hook-"!==e.substr(0,5))"data-"===e.substr(0,5)&&(o["data:"+e.substr(5)]=r[e]),o[e]=r[e];else{const t=r[e];"function"!=typeof t&&null!=t||(o["hook:"+e.substr(5)]=t)}else{const t=r[e];"function"!=typeof t&&null!=t||(o["on:"+e.substr(3)]=t)}else o["n:"+e.substr(2)]=r[e];else o["on:"+e.substr(1)]=r[e];else o["n:"+e.substr(1)]=r[e];else o["n:on"]=r[e];return Ce(e,o,...n)}function Ce(e,t,...n){const r="object"==typeof t&&t||{},o={[te]:"$$$objectType$$$Element",tag:e,props:r,children:n,key:void 0};return"n:key"in r&&(o.key=r["n:key"]),"n:slot"in r&&(o.slot=r["n:slot"]),o}function ke(e,{slot:t,key:n}={}){return{[te]:"$$$objectType$$$Element",tag:N,props:{"n:key":n,"n:slot":t},children:[e],key:n,slot:t}}function Ne(e,t={}){if(Array.isArray(e)){const n=[];for(let r of e)n.push(Ne(r,t));return[].concat(...n)}if(!be(e))return[e];let{tag:n}=e;if(!n)return[e];if("template"===n)return Ne(e.children,t);if(!pe(n))return[e];const{simple:r}=t;if(Array.isArray(r)){if(r.includes(n))return[e]}else if("function"==typeof r){if(r(n))return[e]}else if(r)return[e];return Ne(e.children,t)}function Se(e,t){if(Object.is(e,t))return!0;if(!e)return!1;if(!t)return!1;if("object"!=typeof e)return!1;if("object"!=typeof t)return!1;if(Array.isArray(e)){if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(let n=e.length-1;n>=0;n--)if(!Se(e[n],t[n]))return!1;return!0}if(Array.isArray(t))return!1;if(!be(e))return!1;if(!be(t))return!1;if(e.tag!==t.tag)return!1;if(e.execed!==t.execed)return!1;if(e.inserted!==t.inserted)return!1;if(e.isDefault!==t.isDefault)return!1;if(e.key!==t.key)return!1;if(e.slot!==t.slot)return!1;const n=e.props,r=t.props;if(Object.is(n,r))return Se(e.children,t.children);if(!n)return!1;if(!r)return!1;if("object"!=typeof n)return!1;if("object"!=typeof r)return!1;const o=new Set(Object.keys(n)),s=Object.keys(r);if(o.size!==s.length)return!1;for(const e of s){if(!o.has(e))return!1;if(n[e]!==r[e])return!1}return Se(e.children,t.children)}function De(...e){return{[te]:"$$$objectType$$$Element",tag:"template",children:e}}function Te(...e){}function Ae(e,t){return{...e,id:0}}function Oe(e){}let Ee;function Pe(e){Ee=e}function He(e){Ee?Ee.push(e):e()}class Me{constructor(e,t,r,o,s,i){n(this,"tag",void 0),n(this,"attrs",void 0),n(this,"renderer",void 0),n(this,"labels",void 0),n(this,"parentProxy",void 0),n(this,"delivered",void 0),n(this,"created",!1),n(this,"destroyed",!1),n(this,"mounted",!1),n(this,"unmounted",!1),n(this,"tree",[]),n(this,"container",void 0),n(this,"componentRoot",void 0),n(this,"originalTag",void 0),n(this,"__executed_destroy",!1),n(this,"__mountOptions",null),n(this,"__cancelDrawMonitor",void 0),n(this,"__executed_unmounted",!1),this.originalTag=t,this.tag=r,this.renderer=e,this.attrs=o,this.parentProxy=s,this.delivered=i||(null==s?void 0:s.delivered)||Object.create(null)}update(e,t){this.attrs=e,this._update(e,t)}destroy(){return!this.__executed_destroy&&(this.__executed_destroy=!0,this.callHook("beforeDestroy"),this._destroy(),this.callHook("destroyed"),this.destroyed=!0,!0)}mount(e){if(this.__executed_destroy)return!1;if(!e)return!1;if(this.__mountOptions)return!1;this.__mountOptions=e,this.callHook("beforeMount");const t=f(e=>e&&this.requestDraw(),()=>{const t=this._mount(e);this.__mountOptions=t||e,this.mounted=!0});return this.__cancelDrawMonitor=t.stop,He(()=>this.callHook("mounted")),!0}unmount(){return!!this.mounted&&(!this.__executed_unmounted&&(this.__executed_unmounted=!0,this.callHook("beforeUnmount"),this._unmount(),this.callHook("unmounted"),this.unmounted=!0,!0))}redraw(){if(this.__executed_destroy)return;if(!this.mounted)return;const e=this.__mountOptions;if(!e)return;this.__cancelDrawMonitor&&this.__cancelDrawMonitor(),this.callHook("beforeDraw");const t=f(e=>e&&this.requestDraw(),()=>this._redraw(e));this.__cancelDrawMonitor=t.stop,He(()=>this.callHook("drawn"))}}class qe extends Me{constructor(e,t,r,o,s,i){super(s.renderer,e,t,r,s,i),n(this,"container",void 0),n(this,"componentRoot",void 0),this.container=s.container,this.componentRoot=s.componentRoot}requestDraw(){this.mounted&&(this.destroyed||this.container.markDraw(this))}callHook(e){}}function Fe(e){return Ae({tag:null,node:e.createPlaceholder()})}function Ie(e,t,n){if(!n)return Fe(e);const{proxy:r}=n;return r.mount(t),Ae({...n,node:void 0,proxy:r})}function Ve(e,t,n){return n.length?n.map(n=>Ie(e,t,n)):[Fe(e)]}function Le(e,t,n){return n.length?n.map(n=>Array.isArray(n)?Ve(e,t,n):Ie(e,t,n)):[Fe(e)]}function*ze(e){if(Array.isArray(e)){for(const t of e)yield*ze(t);return}const{node:t,proxy:n}=e;t?yield t:n&&(yield*ze(n.tree))}function Be(e,t){if(t)if(Array.isArray(t))t.forEach(t=>Be(e,t));else if(t.proxy){const{proxy:e}=t;e.unmount()}else{if(t.node){const{node:n}=t;e.removeNode(n)}Be(e,t.children)}}function Ke(e){return Array.isArray(e)?Ke(e[e.length-1]):e.node?e.node:Ke(e.proxy.tree)}function We(e){return Array.isArray(e)?We(e[0]):e.node?e.node:We(e.proxy.tree)}function Ue(e,t,n){const r=We(n);if(!r)return t;const o=e.getParent(r);if(!o)return t;for(const n of ze(t))e.insertNode(o,n,r);return Be(e,n),t}function Ge(e,t,n,r){if(!n.length){return[Ue(e,Fe(e),r)]}Array.isArray(r)||(r=[r]);const o=[],s=[...r],i=new Map;for(const r of n){const n=s.findIndex(e=>e.tag===r.tag&&e.key===r.key&&e.proxy===r.proxy);if(n>=0){const c=s[n],u=Je(e,t,r,c);i.set(c,u),o.push(u),s.splice(n,1)}else{const n=Ie(e,t,r);o.push(n)}}if(!i.size)return Ue(e,o,s);Be(e,s);const c=Ke((r=r.filter(e=>i.has(e))).map(e=>i.get(e)).filter(Boolean)),u=e.getParent(c);if(!u)return o;let d=e.nextNode(c);for(let t=o.length-1;t>=0;t--){const n=o[t],s=r.findIndex(e=>i.get(e)===n);if(s>=0)for(const e of r.splice(s))i.delete(e);else for(const t of ze(n))e.insertNode(u,t,d);d=We(n)||d}return o}function Je(e,t,n,r){if(!n){if(Array.isArray(r)){if(1===r.length&&null===r[0].tag)return r[0]}else if(null===r.tag)return r;return Ue(e,Fe(e),r)}if(Array.isArray(r)){const o=r.findIndex(e=>e.tag===n.tag&&e.proxy===n.proxy);if(o<0)return Ue(e,Ie(e,t,n),r);const s=r;[r]=r.splice(o,1),Be(e,s)}if(n.proxy){const{proxy:o}=n;return o!==r.proxy?Ue(e,Ie(e,t,n),r):Ae({...n,node:void 0,proxy:o},r.id)}return r.proxy||n.tag!==r.tag?Ue(e,Ie(e,t,n),r):void 0===n.tag?r:Ue(e,Ie(e,t,n),r)}function Qe(e,t,n,r){return r?function(e,t,n,r){if(0===n.length)return Ue(e,Le(e,t,[]),r);let o=0,s=Math.min(n.length,r.length);const i=[];for(;o<s;o++){const s=n[o];Array.isArray(s)?i.push(Ge(e,t,s,r[o])):i.push(Je(e,t,s,r[o]))}if(s=Math.max(n.length,r.length),r.length>o)for(;o<s;o++)Be(e,r[o]);if(n.length>o){const r=Ke(i[i.length-1]),c=e.getParent(r),u=e.nextNode(r);for(;o<s;o++){const r=n[o],s=Array.isArray(r)?Ve(e,t,r):Ie(e,t,r);if(i.push(s),c)for(const t of ze(s))e.insertNode(c,t,u)}}return i}(e,t,n,r):Le(e,t,n)}class Xe extends qe{get content(){return this.tree}constructor(e,t,r,o,s){super(e,t,r,o,s,Object.create(s.delivered)),n(this,"__valueObject",void 0),n(this,"__nodes",void 0);const{value:i}=r;this.__valueObject=i,Reflect.defineProperty(this.delivered,t[he],{configurable:!0,enumerable:!0,get:()=>(a(this,"value"),this.__valueObject)}),this.__nodes=Xt(this,o),this.created=!0}_update({value:e},t){this.__valueObject!==e&&(this.__valueObject=e,l(this,"value")),this.__nodes=Xt(this,t,this.__nodes),this.requestDraw()}_destroy(){At(this.__nodes)}_mount(e){this.tree=Qe(this.renderer,e,this.__nodes)}_redraw(e){const{renderer:t,__nodes:n,tree:r}=this;this.tree=Qe(t,e,n,r)}_unmount(){Be(this.renderer,this.tree)}}let Ye=0;const Ze=new Set;function et(e){return!(Ye<=0)&&(Ze.add(e),!0)}function tt(){if(Ye>0)return;const e=[...Ze];Ze.clear(),e.forEach(e=>e.refresh())}function nt(e,t){if(t)return async function(e){try{return Ye++,await e()}finally{Ye--,tt()}}(e);try{return Ye++,e()}finally{Ye--,tt()}}function rt(e,t=[]){const n=(t,n,r)=>nt(()=>{const o=Boolean(null==r?void 0:r.cancelable),{target:s}=e;let i=!0;const c={get target(){return s},get cancelable(){return o},get defaultPrevented(){return i},get prevented(){return i},preventDefault(){i=!1},prevent(){i=!1}},u=e.events[t];if(!u)return i;for(const e of u)e(n,c);return i});return n.omit=(...n)=>rt(e,[...t,...n]),Reflect.defineProperty(n,"names",{get:()=>(a(rt,"names"),[...e.names].filter(e=>!t.includes(e))),configurable:!0}),n}class ot{get names(){return a(this,"names"),[...this._names]}constructor(){n(this,"_names",new Set),n(this,"events",Object.create(null)),n(this,"emit",rt(this)),n(this,"on",void 0),n(this,"target",void 0),n(this,"__propsEvents",Object.create(null)),n(this,"__eventMap",Object.create(null)),n(this,"__propsEmitEvents",Object.create(null)),n(this,"__propsEmitEvent",void 0);const e=this._names,t=this.events;this.on=(n,r)=>{var o;function s(e,t){try{r(e,t)}catch(e){u(e)}}let i=t[n];(null===(o=i)||void 0===o?void 0:o.size)?i.add(s):(i=new Set,i.add(s),t[n]=i,e.add(n),l(this,"names"));let c=!1;return()=>{c||(c=!0,i&&(i.delete(s),i.size||(e.delete(n),l(this,"names"))))}}}updateInProps(e){const t=this.__propsEvents,n=new Set(Object.keys(t));for(const[r,o]of function*(e){if(!e)return;for(const t of Object.keys(e)){const n=e[t];if("function"!=typeof n)continue;if("on:"!==t.substr(0,3))continue;const r=t.substr(3);r&&(yield[r,n])}}(e)){if(n.has(r)){n.delete(r);const[e,s]=t[r]||[];if(e===o)continue;s&&s()}t[r]=[o,this.on(r,o)]}for(const e of n){const n=t[e];n&&(n[1](),delete t[e])}const r=this.__eventMap,o=new Set(Object.keys(r));for(const[t,n]of function*(e){if(!e)return;const t=e["n:on"];if(!t)return;if("object"==typeof t)return;for(const t of Object.keys(e)){const n=e[t];"function"==typeof n&&(yield[t,n])}}(e)){if(o.has(t)){o.delete(t);const[e,s]=r[t]||[];if(e===n)continue;s&&s()}r[t]=[n,this.on(t,n)]}for(const e of o){const t=r[e];t&&(t[1](),delete r[e])}const s=this.__propsEmitEvents,i=function(e){if(!e)return;let t=null==e?void 0:e["n:on"];if("function"!=typeof t)return;return t}(e);if(i!==this.__propsEmitEvent){this.__propsEmitEvent=i;for(const e of[...Object.keys(s)]){const t=s[e];t&&(t(),delete s[e])}if(!i)return;const{names:e}=i;if(!Array.isArray(e))return;for(const t of e)s[t]=this.on(t,e=>i(t,e));return}if(!i)return;const c=new Set(Object.keys(s)),u=i.names||[];for(const e of u)e&&(c.delete(e),c.has(e)||(s[e]=this.on(e,t=>i(e,t))));for(const e of c){const t=s[e];t&&(t(),delete s[e])}}}function st(e,t,n,r=!1){const o=[];for(const s of t){if(Array.isArray(s)){const t=Object.create(null);o.push(st(e,s,t,r));for(const e of Reflect.ownKeys(t))e in n?n[e].push(t[e]):n[e]=[t[e]];continue}if(be(s)&&void 0===s.slot&&(pe(s.tag)&&s.execed||"template"===s.tag)){const t=Object.create(null);o.push(st(e,s.children,t,r));for(const e of Reflect.ownKeys(t)){const r={...s,children:t[e]};e in n?n[e].push(r):n[e]=[r]}continue}if(r){if(e.isNode(s)){o.push(s);continue}if(!be(s)){o.push(s);continue}if(s.tag!==N&&"template"!==s.tag){o.push(s);continue}}const t=be(s)&&s.slot||"default",i=be(s)?{...s,slot:void 0,props:{...s.props,"n:slot":void 0}}:s;t in n?n[t].push(i):n[t]=[i]}return o}function it(e,t,n){return Reflect.defineProperty(e,t,{get:()=>(a(e,t),n),enumerable:!0,configurable:!0}),l(e,t),n}function ct(e,t,n){if(!t){const t=Object.create(null);for(const n of Reflect.ownKeys(e))t[n]=e[n];return t}for(const n of Reflect.ownKeys(t))n in e||it(t,n);if(!n){for(const n of Reflect.ownKeys(e)){it(t,n,e[n])}return t}for(const r of Reflect.ownKeys(e)){const o=e[r];Se(o,n[r])||it(t,r,o)}return t}function ut(e,t){return e.map(e=>{if(Array.isArray(e))return ut(e,t);if(!be(e))return e;if(e.tag!==N)return{...e,slot:void 0};const{children:n}=e;if(1!==(null==n?void 0:n.length))return n;const[r]=n;return m(r)||"function"!=typeof r?n:r(t)})}function dt(e,t,n){return n||t in e?e[t]:it(e,t)}function at(e,t=!1){function n(n="default",r={}){const o=dt(e,n,t);return{[te]:"$$$objectType$$$Element",tag:k,children:o?ut(o,r):[],inserted:!0,slot:n,isDefault:!o}}return n.has=(n="default")=>Boolean(dt(e,n,t)),n}const lt=[];function ht(e,t){for(const n of lt)n(e,t);return e}function ft(e){lt.push(d(e))}function pt(e,t){o(ge(t),"The `deliver` is not a DeliverComponent.","deliver");const n=e[t[he]];return void 0===n?t[fe]:n}const _t=Object.create(null);function yt(e,t){_t[e]=t}function mt(e,t,n){if(!e)return null;if("string"!=typeof e)return e;if(/^core:/i.test(e)){let t=e.toLowerCase();return t===D||(t===k||t===N)?t:t===S?n?"slot":k:"template"}if("template"===e)return e;if("slot"===e)return e;for(const n of t){const t=n[e];if(t)return t}return _t[e]||e}function vt(...e){return e.filter(Boolean)}function $t(e){return Array.isArray(e)?e:be(e)?"template"!==e.tag?[e]:e.children:[e]}function gt(e,t,n,r,o,s){var i;if(Array.isArray(e))return e.map(e=>gt(e,t,n,r,o,s));if(!be(e))return e;if(e.tag===k&&e.inserted)return e;const{children:c}=e,u=mt(e.tag,r,o);if(pe(u))return e.execed?e:function(e,t,n,r,o){const s=Object.create(null);st(e.renderer,o,s);const i=ct(s),c=new ot;c.updateInProps(t.props);const{refresh:u,delivered:d,simpleParent:a}=e,l=wt(e,$t(n({...t.props},ht({isShell:!0,slot:at(i,!0),parent:a,delivered:e=>pt(d,e),childNodes:o,refresh:u,emit:c.emit}))),i,vt(...r,n[Y]),!1,!0);return{...t,tag:n,execed:!0,children:Array.isArray(l)?l:[l]}}(t,e,u,r,c.map(e=>gt(e,t,n,r,o,s)));if(u===N){const s=function(e,t,n,r,o){if(1!==t.length)return null;const[s]=t;if(m(s)||"function"!=typeof s)return null;const{slotRenderFnList:i}=e,c=i.get(s);if(c)return c;const u=function(...t){return wt(e,s.call(this,...t),n,r,o,!1)};return i.set(s,u),u}(t,c,n,r,o);if(s)return{...e,children:[s]}}if(u!==k)return{...e,tag:u,children:c.map(e=>gt(e,t,n,r,o,s))};const{props:d}=e,a=(null==d?void 0:d.argv)||{},l=(null===(i=e.props)||void 0===i?void 0:i.name)||"default",h=s||l in n?n[l]:it(n,l);return{[te]:"$$$objectType$$$Element",props:d,key:e.key,tag:k,inserted:!0,slot:l,isDefault:!h,children:h?ut(h,a):bt(c,a).map(e=>gt(e,t,n,r,o,s))}}function bt(e,t){if(1!==e.length)return e;const[n]=e;return"function"!=typeof n?e:$t(n(t))}function wt(e,t,n,r,o,s){return nt(()=>h(()=>gt(t,e,n,r,o,s)))}function xt(e,t,n,r,o=e.tag[Y]||null){return wt({renderer:e.renderer,refresh:n,slotRenderFnList:t,delivered:e.delivered,simpleParent:e.entity},$t(r),e.slots,vt(o),Boolean(e.isNative),!1)}function jt(e){return null==e?null:e instanceof Date?e.toISOString():(RegExp,String(e))}class Rt extends qe{get content(){return this.tree}set value(e){const t=e!==this.__value;this.__value=e,t&&l(this,"value")}get value(){a(this,"value");let e=this.__value;for(;m(e);)e=e();return e}constructor(e,t){super(null,null,e,[],t),n(this,"__value",void 0),n(this,"text",void 0),n(this,"isValue",void 0),n(this,"__nodes",void 0),n(this,"src",void 0),n(this,"__render",void 0),n(this,"__refreshing",!1),n(this,"__needRefresh",!1);const{value:r}=e;this.__value=r;const o=Object.create(null),s={renderer:this.renderer,refresh:()=>this.refresh(),slotRenderFnList:new WeakMap,delivered:this.delivered,simpleParent:void 0};this.__render=p(e=>e&&this.refresh(),()=>{let{value:e}=this;if(be(e)||Array.isArray(e))return this.__nodes=Xt(this,wt(s,be(t=e)?"template"!==t.tag?[t]:t.children:[t],o,[],!1,!1),this.__nodes),!0;var t;if(this.__nodes)At(this.__nodes),this.__nodes=void 0;else if(this.src===e)return!1;return this.src=e,!0}),this.created=!0,this.refresh()}refresh(){if(this.destroyed)return;if(this.__needRefresh=!0,!this.created)return;if(this.__refreshing)return;this.__refreshing=!0;let e=!1;for(;this.__needRefresh&&!et(this);)if(this.__needRefresh=!1,e=this.__render()||e,this.destroyed)return;this.__refreshing=!1,e&&(et(this)||this.mounted&&(this.destroyed||this.unmounted||this.requestDraw()))}_update({value:e}){this.value=e}_destroy(){this.__render.stop();const{__nodes:e}=this;e&&At(e)}_mount(e){const{renderer:t,__nodes:n,src:r}=this;if(n)return void(this.tree=Qe(t,e,n));if(t.isNode(r))return void(this.tree=[Ae({node:r})]);const o=jt(r),s="string"==typeof o?Ae({node:t.createText(o)}):Fe(t);this.tree=[s]}_redraw(e){const{renderer:t,__nodes:n,src:r}=this;if(n)return void(this.tree=Qe(t,e,n,this.tree));if(t.isNode(r))return void(this.tree=[Ae({node:r})]);const o=jt(r),s="string"==typeof o?Ae({node:t.createText(o)}):Fe(t);this.tree=Ue(t,[s],this.tree)}_unmount(){const{renderer:e,tree:t}=this;Be(e,t)}}class Ct extends qe{get content(){return this.tree}constructor(e,t,r){super(e,e,{},t,r),n(this,"__nodes",void 0),this.__nodes=Xt(this,t)}_update(e,t){this.__nodes=Xt(this,t,this.__nodes),this.requestDraw()}_destroy(){At(this.__nodes)}_mount(e){this.tree=Qe(this.renderer,e,this.__nodes)}_redraw(e){this.tree=Qe(this.renderer,e,this.__nodes,this.tree)}_unmount(){Be(this.renderer,this.tree)}}function kt(e,t){const n=new Set(Object.keys(t));for(const r in e){if("data:"!==r.substr(0,5))continue;const o=r.substr(5);o&&(n.delete(o),t[o]=e[o])}const r=e["n:data"];if(r&&"object"==typeof r)for(const e in r)e&&(n.delete(e),t[e]=r[e]);for(const e of n)delete t[e]}class Nt extends Me{get exposed(){return this.__exposed}setExposed(e){if(this.destroyed)return;const t=this.__ref;if("function"!=typeof t)return void(this.__exposed=e);const n=this.__exposed;this.__exposed=e,t(e,n,this.entity)}constructor(e,t,r,o,s,i){super(e,t,r,o,s,i),n(this,"__exposed",void 0),n(this,"__ref",void 0),n(this,"events",void 0),n(this,"entity",void 0),n(this,"data",Object.create(null)),kt(o,this.data);const c=new ot,u=this.createEntity(c);c.target=u,this.entity=u,this.events=c;const d=o["n:ref"];"function"==typeof d&&(this.__ref=d,d(void 0,void 0,u,!0))}update(e,t){kt(e,this.data);const n=e["n:ref"],r=this.__ref;n!==r&&("function"==typeof n?n(this.__exposed):r&&(this.__ref=void 0)),super.update(e,t)}destroy(){if(!super.destroy())return!1;const e=this.__ref;return"function"!=typeof e||e(void 0,this.__exposed,this.entity,!1),!0}}class St extends Nt{constructor(e,t,r,o,s){super(s.renderer,e,t,r,s),n(this,"container",void 0),n(this,"componentRoot",void 0),n(this,"props",void 0),n(this,"__nodes",void 0),n(this,"node",void 0),n(this,"content",[]),n(this,"__elementTagData",void 0),this.container=s.container,this.componentRoot=s.componentRoot,this.props=r,this.events.updateInProps(r),this.__nodes=Xt(this,o),this.__elementTagData="string"==typeof t?t:t[ee]}requestDraw(){this.mounted&&(this.destroyed||this.container.markDraw(this))}callHook(e){}createEntity(e){const t={data:{configurable:!0,value:this.data},exposed:{configurable:!0,get:()=>this.exposed},on:{configurable:!0,value:e.on},emit:{configurable:!0,value:e.emit}};return Object.create(null,t)}_update(e,t){this.props=e,this.events.updateInProps(e),this.__nodes=Xt(this,t,this.__nodes),this.requestDraw()}_destroy(){this.destroyed||(this.destroyed=!0,At(this.__nodes))}_mount(e){if(this.node)return;const{renderer:t,__elementTagData:n,props:r,__nodes:o}=this,s=t.createElement(n,r,e);if(!s)return;this.node=s,this.setExposed(s);const i=t.getMountOptions(s,e)||e;if(o){const e=Qe(t,i,o);this.content=e;for(const n of ze(e))t.insertNode(s,n)}return this.tree=[Ae({node:s})],t.updateProps(s,n,r,this.events.emit,i),i}_redrawChildren(e){const{renderer:t,__nodes:n,content:r,node:o}=this;if(o)if(!n.length&&r.length)Be(t,r),this.content=[];else if(n.length&&r.length)this.content=Qe(t,e,n,r);else if(n.length&&!r.length){const r=Qe(t,e,n);this.content=r;for(const e of ze(r))t.insertNode(o,e)}}_redraw(e){this._redrawChildren(e);const{renderer:t,__elementTagData:n,node:r,props:o}=this;r&&t.updateProps(r,n,o||{},this.events.emit,e)}_unmount(){const{renderer:e,tree:t,node:n}=this;n&&(e.removeNode(n),Be(e,t))}}class Dt extends Nt{get content(){return this.tree}requestDraw(){this.mounted&&(this.destroyed||this.container.markDraw(this))}callHook(e){}createEntity(e){const t={data:{configurable:!0,value:this.data},exposed:{configurable:!0,value:void 0},on:{configurable:!0,value:e.on},emit:{configurable:!0,value:e.emit}};return Object.create(null,t)}constructor(e,t,r,o,s){super(s.renderer,e,t,r,s),n(this,"props",void 0),n(this,"childNodes",void 0),n(this,"src",void 0),n(this,"slots",Object.create(null)),n(this,"lastSlots",void 0),n(this,"__render",void 0),n(this,"container",void 0),n(this,"componentRoot",void 0),n(this,"__refreshing",!1),n(this,"__needRefresh",!1),n(this,"__delayedRefresh",0),n(this,"_nodes",[]),this.container=s.container,this.componentRoot=s.componentRoot,this.props=r,this.childNodes=o;const{slots:i}=this,c=this,{delivered:u}=this,d=e=>{this.refresh(e)},a=this.events,l=ht({isShell:!0,delivered:e=>pt(u,e),slot:at(i),refresh:d,get childNodes(){return c.childNodes},emit:a.emit}),h={renderer:this.renderer,refresh:d,slotRenderFnList:new WeakMap,delivered:this.delivered,simpleParent:void 0};this.__render=p(e=>e&&this.refresh(),()=>{const e={...this.props};a.updateInProps(e);const n=t(e,l);return wt(h,function(e){return Array.isArray(e)?e:be(e)?"template"!==e.tag?[e]:e.children:[e]}(n),i,[],!1,!1)}),this.created=!0,this.refresh(),this._nodes=Xt(this,this.__render())}refresh(e){if("function"==typeof e)try{return this.__delayedRefresh++,e()}finally{this.__delayedRefresh--,this.__delayedRefresh<=0&&this.refresh()}if(this.destroyed)return;if(this.__needRefresh=!0,!this.created)return;if(this.__refreshing)return;let t;for(this.__refreshing=!0;this.__needRefresh&&!et(this);)if(this.__needRefresh=!1,t=this.__render(),this.destroyed)return;this.__refreshing=!1,t&&(this._nodes=Xt(this,t,this._nodes),et(this)||this.mounted&&(this.destroyed||this.unmounted||this.requestDraw()))}_update(e,t){this.props=e;const n=Object.create(null);st(this.renderer,t,n),ct(n,this.slots,this.lastSlots),this.lastSlots=n,this.childNodes=t,this.refresh()}_destroy(){this.__render.stop(),At(this._nodes)}_mount(e){this.tree=Qe(this.renderer,e,this._nodes)}_redraw(e){this.tree=Qe(this.renderer,e,this._nodes,this.tree)}_unmount(){Be(this.renderer,this.tree)}}function Tt(e){return!1===e||null==e?null:be(e)?e:{key:e,props:{value:e},children:[]}}function At(e){if(!e)return;if(Array.isArray(e))return void e.forEach(e=>At(e));const{proxy:t}=e;return t?t.destroy():void 0}class Ot extends qe{get content(){return this.tree}constructor(e,t,r){super(k,k,{},[],t),n(this,"__nodes",void 0),this.__nodes=Xt(this,e)}_update(e,t){this.mounted&&(this.destroyed||(this.__nodes=Xt(this,t,this.__nodes),this.requestDraw()))}_destroy(){At(this.__nodes)}_mount(e){this.tree=Qe(this.renderer,e,this.__nodes)}_redraw(e){this.tree=Qe(this.renderer,e,this.__nodes,this.tree)}_unmount(){Be(this.renderer,this.tree)}}const Et=[];function Pt(e){Et.push(d(e))}function Ht(e,t){var n;const r={[te]:{configurable:!0,value:"$$$objectType$$$HookEntity"},data:{configurable:!0,value:e.data},exposed:{configurable:!0,get:()=>e.exposed},parent:{configurable:!0,value:null===(n=e.parentComponentProxy)||void 0===n?void 0:n.entity},component:{configurable:!0,value:e.tag},created:{configurable:!0,get:()=>e.created},destroyed:{configurable:!0,get:()=>e.destroyed},mounted:{configurable:!0,get:()=>e.mounted},unmounted:{configurable:!0,get:()=>e.unmounted},$_hooks:{configurable:!0,value:Object.create(null)},$_useHookValues:{configurable:!0,value:[]},callHook:{configurable:!0,value(e){B(e,o)}},setHook:{configurable:!0,value:(e,t)=>z(e,t,o)},refresh:{configurable:!0,value:e.refresh.bind(e)},on:{configurable:!0,value:t.on},emit:{configurable:!0,value:t.emit}},o=Object.create(null,r);return function(e){for(const t of Et)t(e);return e}(o)}const Mt=new Set([":","@","#","*","!","%","^","~","&","?","+",".","(",")","[","]","{","}","<",">"]);function qt(e){return"string"!=typeof e||!Mt.has(e[0])&&("n:"!==e.substr(0,2)&&"on:"!==e.substr(0,3))}class Ft extends Nt{callHook(e){B(e,this.entity)}constructor(e,t,r,o,s){super(s.renderer,e,t,r,s),n(this,"isNative",!1),n(this,"container",void 0),n(this,"componentRoot",void 0),n(this,"children",new Set),n(this,"emit",void 0),n(this,"on",void 0),n(this,"components",Object.create(null)),n(this,"props",void 0),n(this,"propsDefined",void 0),n(this,"slots",Object.create(null)),n(this,"lastSlots",void 0),n(this,"nativeNodes",void 0),n(this,"parentComponentProxy",void 0),n(this,"_render",void 0),n(this,"_stopRender",void 0),n(this,"childNodes",[]),n(this,"__refreshing",!1),n(this,"__needRefresh",!1),n(this,"__delayedRefresh",0),n(this,"_nodes",[]),this.container=s.container,this.componentRoot=this,this.parentComponentProxy=s.componentRoot;const{events:i}=this;this.emit=i.emit,this.on=i.on,Object.assign(this.components,t[Y]);const c=t[Z];Array.isArray(c)?(this.propsDefined=c,this.props=w(c,null)):(this.propsDefined=[],this.props=R(Object.create(null))),this._init(),this.callHook("beforeCreate"),this._update(r,o);const{render:u,nodes:d,stopRender:a}=this._initRender();this._render=u,this._stopRender=a,this._nodes=Xt(this,d),this.callHook("created"),this.created=!0,this.needRefresh&&this.refresh()}createEntity(e){return Ht(this,e)}_update(e,t){this.destroyed||(this.childNodes=t,nt(()=>h(()=>function(e,t,n){const{props:r,isNative:o}=e,s=new Set(Object.keys(t).filter(qt));e.propsDefined.forEach(e=>s.add(e));for(const e of Object.keys(r))qt(e)&&!s.has(e)&&delete r[e];for(const e of s)r[e]=t[e];e.events.updateInProps(t);const i=Object.create(null),c=st(e.renderer,n,i,o);ct(i,e.slots,e.lastSlots),e.lastSlots=i,o&&(e.nativeNodes=Xt(e,c,e.nativeNodes),e.mounted&&e.requestDraw())}(this,e,t))))}_destroy(){this._stopRender(),At(this._nodes)}get needRefresh(){return this.__needRefresh}refresh(e){if("function"==typeof e)try{return this.__delayedRefresh++,e()}finally{this.__delayedRefresh--,this.__delayedRefresh<=0&&this.refresh()}if(this.destroyed)return;if(this.__needRefresh=!0,!this.created)return;if(this.__refreshing)return;let t;for(this.__refreshing=!0;!et(this)&&!this.__delayedRefresh&&this.__needRefresh;)if(this.__needRefresh=!1,t=this._render(),this.destroyed)return;this.__refreshing=!1,et(this)||this.__delayedRefresh||t&&(this._nodes=Xt(this,t,this._nodes),this.mounted&&(this.destroyed||this.unmounted||this.requestDraw()))}requestDraw(){this.container.markDraw(this)}}function It(e){const{tag:t,props:n,entity:r}=e,o=ht({isShell:!1,slot:at(e.slots),expose:t=>e.setExposed(t),get created(){return e.created},get parent(){var t;return null===(t=e.parentComponentProxy)||void 0===t?void 0:t.entity},get children(){return[...e.children].map(e=>e.exposed)},get childNodes(){return e.childNodes},get emit(){return e.emit},delivered:t=>pt(e.delivered,t),refresh(t){e.refresh(t)}},r),s=t[ee],i="function"!=typeof s?()=>De(...e.childNodes):()=>I(r,0,()=>s(n||{},o)),c={renderer:e.renderer,refresh:t=>e.refresh(t),slotRenderFnList:new WeakMap,delivered:e.delivered,simpleParent:e.entity},u=e.tag[Y],d=u?[u]:[],a=p(t=>t&&e.refresh(),()=>{return wt(c,(t=i(),Array.isArray(t)?t:be(t)?"template"!==t.tag?[t]:t.children:[t]),e.slots,d,!1,!1);var t});return{nodes:a(),render:a,stopRender:()=>a.stop()}}class Vt extends Ft{constructor(...e){super(...e),n(this,"nativeNodes",void 0),n(this,"childNodes",[])}get content(){return this.tree}_init(){}_initRender(){return It(this)}_destroy(){this._stopRender(),At(this._nodes)}requestDraw(){this.container.markDraw(this)}_redraw(e){const{renderer:t,_nodes:n}=this;this.tree=Qe(t,e,n,this.tree)}_mount(e){const{renderer:t,_nodes:n}=this;this.tree=Qe(t,e,n)}_unmount(){const{renderer:e}=this;Be(e,this.tree)}}function Lt(e,t,n){const r=new WeakMap,o=p(t=>t&&e.refresh(),()=>xt(e,r,t=>e.refresh(t),t(),n));return{nodes:o(),render:o,stopRender:()=>o.stop()}}class zt extends Ft{constructor(...e){super(...e),n(this,"content",[]),n(this,"native",void 0),n(this,"shadowTree",[]),n(this,"nativeTree",[]),n(this,"_shadow",void 0),n(this,"childNodes",[]),n(this,"__nativeTreeNountOptions",void 0)}_init(){var e,t;if(!ye(this.tag))return;const n=null===(e=(t=this.renderer).createComponent)||void 0===e?void 0:e.call(t);n&&([this.native,this._shadow]=n)}_initRender(){return function(e){const{tag:t,props:n,entity:r}=e,o=ht({isShell:!1,slot:at(e.slots),expose:t=>e.setExposed(t),get created(){return e.created},get parent(){var t;return null===(t=e.parentComponentProxy)||void 0===t?void 0:t.entity},get children(){return[...e.children].map(e=>e.exposed)},get childNodes(){return e.childNodes},get emit(){return e.emit},delivered:t=>pt(e.delivered,t),refresh(t){e.refresh(t)}},r),s=t=>{t&&e.refresh()},i=f(s,{resultOnly:!0},()=>I(r,0,()=>t(n,o)));if("function"==typeof i)return Lt(e,i);if(xe(i)){const{children:t}=i;if(1===(null==t?void 0:t.length)&&"function"==typeof t[0])return Lt(e,t[0])}if(be(i)&&me(i.tag)){const{tag:t}=i,n=t[ee];if("function"==typeof n)return Lt(e,()=>n(i.props||{},o),i.tag[Y]||null)}const c=t=>{e.refresh(t)},u=new WeakMap,d=p(s,()=>xt(e,u,c,I(r,0,()=>t(n,o))));return{nodes:f(s,()=>xt(e,u,c,i),{resultOnly:!0}),render:d,stopRender:()=>d.stop()}}(this)}_destroy(){this._stopRender(),At(this._nodes)}requestDraw(){this.container.markDraw(this)}_mount(e){const{nativeNodes:t,renderer:n,_shadow:r,native:o,_nodes:s}=this;if(!o||!t||!r)return void(this.tree=this.content=Qe(n,e,s));this.tree=[Ae({node:o})];const i=n.getMountOptions(r,e)||e;this.content=Qe(n,i,s);for(const e of ze(this.content))n.insertNode(r,e);const c=n.getMountOptions(o,e)||e;this.nativeTree=Qe(n,c,t);for(const e of ze(this.nativeTree))n.insertNode(o,e);return this.__nativeTreeNountOptions=c,i}_redraw(e){const{nativeNodes:t,renderer:n,__nativeTreeNountOptions:r,_nodes:o}=this;this.content=Qe(n,e,o,this.content),t&&r?this.nativeTree=Qe(n,r,t,this.nativeTree):this.tree=this.content}_unmount(){const{renderer:e,nativeTree:t}=this;Be(e,this.tree),t&&Be(e,t)}}const Bt=[];function Kt(e){Bt.push(e)}function Wt(e,{tag:t,props:n,children:r,isDefault:o}){if(t===D)return new dn(t,null,n,r,e);if(t===k)return new Ot(r,e,o);if("template"===t)return new Ct(t,r,e);if("string"==typeof t)return"core:"===t.substr(0,5)?new Ct(t,r,e):new St(t,t,n||{},r,e);const s=function(e){for(const t of Bt){const n=t(e);if("function"==typeof n)return n}return"function"==typeof e?e:null}(t);return"function"!=typeof s?new Ct(t,r,e):_e(s)?new Dt(t,s,n||{},r,e):ge(s)?new Xe(t,s,n||{},r,e):ve(s)?new dn(t,s,n,r,e):$e(s)?new St(t,s,n||{},r,e):pe(s)?new Ct(t,r,e):me(s)?new Vt(t,s,n||{},r,e):new zt(t,s,n||{},r,e)}function Ut(e,t){if(!t)return null;if(!t.tag){const{key:n,props:r}=t;return{key:n,props:r,proxy:new Rt(t.props||{},e)}}const{tag:n,key:r,props:o}=t;return{tag:n,key:r,props:o,proxy:Wt(e,t)}}function Gt(e,t,n){n||(n=[]),Array.isArray(n)||(n=[n]);const r=[];for(const o of function*e(t){if(Array.isArray(t))for(const n of t)yield*e(n);else yield t}(t)){const t=Tt(o);if(!t)continue;const s=n.findIndex(e=>e.tag===t.tag&&e.key===t.key);if(s>=0){const o=Jt(e,t,n[s]);o&&r.push(o),n.splice(s,1)}else{const n=Ut(e,t);n&&r.push(n)}}return At(n),r}function Jt(e,t,n){if(!n)return Ut(e,t);if(!t)return At(n),null;if(Array.isArray(n)){if(!n.length)return Ut(e,t);const r=n.findIndex(e=>e.tag===t.tag);if(r<0)return At(n),Ut(e,t);const o=n;[n]=n.splice(r,1),At(o)}if(t.tag!==n.tag)return At(n),Ut(e,t);if(n.proxy){const{proxy:e}=n,{props:r={},key:o}=t;return e.update(t.props||{},t.children||[]),{tag:n.tag,props:r,key:o,proxy:e}}return At(n),Ut(e,t)}function*Qt(e,t,n){Array.isArray(t)||(t=[t]);let r=0,o=Math.min(t.length||1,n.length);for(;r<o;r++){const o=t[r];Array.isArray(o)?yield Gt(e,o,n[r]):yield Jt(e,Tt(o),n[r])}if(o=Math.max(t.length,t.length),n.length>r)for(;r<o;r++)At(n[r]);if(t.length>r)for(;r<o;r++){const n=Tt(t[r]);Array.isArray(n)?yield n.flat(1/0).map(t=>Ut(e,t)).filter(Boolean):yield Ut(e,n)}}function Xt(e,t,n){return nt(()=>h(()=>n?[...Qt(e,t,n)]:function(e,t){return Array.isArray(t)||(t=[t]),t.length?t.map(t=>Array.isArray(t)?t.flat(1/0).map(t=>Ut(e,Tt(t))).filter(Boolean):Ut(e,Tt(t))):[]}(e,t)))}let Yt=new Set;const Zt=new Set,en=[],tn=[],nn=[];function rn(e){const t=[...e].sort(([e],[t])=>t-e);e.length=0;try{t.forEach(([,e])=>e())}catch(e){u(e)}}let on=!1;function sn(){var e;on||(on=!0,e=()=>{on=!1,rn(en),function(){const e=[...Yt];Yt.clear(),e.map(e=>e.drawAll())}(),rn(tn),function(){const e=[...Zt];Zt.clear();for(const t of e)try{t()}catch(e){u(e)}}(),rn(nn)},o(s,"The basic renderer is not installed","install"),s(e))}function cn(e,t=0,n){("middle"===n?tn:"end"===n?nn:en).push([t,e]),sn()}function un(e){Zt.add(e),sn()}class dn extends Nt{setmountedRoot(e,t){if(this.parentProxy)return;const n=this.__container;if(!n)return;const{renderer:r}=this,[o,s]=r.getContainer(n,e,t);if(o)for(const e of ze(this.tree))r.insertNode(o,e,s)}constructor(e,t=null,r={},o,s){super(t?c(t[Q],null==s?void 0:s.renderer):c(null==s?void 0:s.renderer),e,t,r,s),n(this,"container",void 0),n(this,"componentRoot",void 0),n(this,"__containerData",void 0),n(this,"content",[]),n(this,"rootContainer",this),n(this,"__nodes",[]),n(this,"__container",null),n(this,"__placeholder",void 0),n(this,"__placeholderNode",void 0),n(this,"__targetNode",null),n(this,"__insertNode",null),n(this,"__nextNode",null),n(this,"__awaitDraw",new Set),n(this,"__containers",new Set),this.container=this,this.componentRoot=null==s?void 0:s.componentRoot,t&&(this.__containerData=t[ee]),this.events.updateInProps(r),s&&(this.rootContainer=s.container.rootContainer),this.__nodes=Xt(this,o),this.created=!0}createEntity(e){return function(e,t){const n={[te]:{configurable:!0,value:"$$$objectType$$$HookEntity"},data:{configurable:!0,value:e.data},exposed:{configurable:!0,get:()=>e.exposed},created:{configurable:!0,get:()=>e.created},destroyed:{configurable:!0,get:()=>e.destroyed},mounted:{configurable:!0,get:()=>e.mounted},unmounted:{configurable:!0,get:()=>e.unmounted},$_hooks:{configurable:!0,value:Object.create(null)},callHook:{configurable:!0,value(e){B(e,r)}},setHook:{configurable:!0,value:(e,t)=>z(e,t,r)},on:{configurable:!0,value:t.on},emit:{configurable:!0,value:t.emit}},r=Object.create(null,n);return r}(this,e)}setChildren(e){this.destroyed||(this.__nodes=Xt(this,e,this.__nodes),this.requestDraw())}_update(e,t){this.destroyed||(this.__nodes=Xt(this,t,this.__nodes),this.events.updateInProps(e),this.requestDraw())}_destroy(){At(this.__nodes)}callHook(e){B(e,this.entity)}requestDraw(){this.markDraw(this)}_mount(e){const{parentProxy:t,renderer:n}=this,r=(null==t?void 0:t.renderer)||n,{container:o,target:s,insert:i,next:c,exposed:u}=n.mountContainer(this.__containerData,this.attrs,this.events.emit,null==t?void 0:t.renderer);console.log(u),this.setExposed(u);const d=n.getMountOptions(o,e)||e,a=Fe(r);this.__placeholder=a;const l=a.node;this.__placeholderNode=l,this.__container=o;const h=Qe(n,d,this.__nodes);if(this.content=h,this.__insertNode=i,this.__nextNode=c,!s&&r===n)return this.tree=i?[...h,Ae({node:i}),a]:[...h,a],d;const f=s||o;this.__targetNode=f;for(const e of ze(h))n.insertNode(f,e,c);return this.tree=i?[Ae({node:i}),a]:[a],d}_redrawSelf(){const{__targetNode:e,__insertNode:t,__nextNode:n}=this,{attrs:r,parentProxy:o,renderer:s}=this,i=this.__placeholder,c=this.__placeholderNode,u=this.__container,d=(null==o?void 0:o.renderer)||s,{target:a,insert:l,next:h}=s.updateContainer(u,e,t,n,this.__containerData,r,this.events.emit,null==o?void 0:o.renderer);this.__insertNode=l,this.__nextNode=h;const f=d.getParent(c);if(l!==t&&(t&&s.removeNode(t),l&&f&&s.insertNode(f,l,c)),a||d!==s){const t=a||u;if(this.__targetNode=t,t!==e||h!==n)for(const e of ze(this.content))s.insertNode(t,e,h);this.tree=l?[Ae({node:l}),i]:[i]}else{const{content:t}=this;if(e&&f){const e=l||c;for(const n of ze(t))d.insertNode(f,n,e);this.__targetNode=null}this.tree=l?[...t,Ae({node:l}),i]:[...t,i]}s.recoveryContainer(u,e,t,n,a,l,h,this.__containerData,r,null==o?void 0:o.renderer)}_redrawChildren(e){const t=Qe(this.renderer,e,this.__nodes,this.content);if(this.content=t,!this.__targetNode)return;const n=this.__placeholder,r=this.__insertNode;this.tree=r?[...t,Ae({node:r}),n]:[...t,n]}_redraw(e){this._redrawChildren(e),this._redrawSelf()}_unmount(){const{parentProxy:e,renderer:t,__insertNode:n}=this,r=(null==e?void 0:e.renderer)||t;Be(this.renderer,this.content),n&&r.removeNode(n),r.removeNode(this.__placeholderNode),t.unmountContainer(this.__container,this.__targetNode,n,this.__nextNode,this.__containerData,this.attrs,null==e?void 0:e.renderer)}markDraw(e){var t;(null===(t=this.parentProxy)||void 0===t?void 0:t.renderer)!==this.renderer?(e===this&&this.parentProxy?this.parentProxy.container.markDraw(this):this.__awaitDraw.add(e),this.rootContainer.markDrawContainer(this)):this.parentProxy.container.markDraw(e)}drawContainer(){if(this.destroyed||!this.__container)return;const{__awaitDraw:e}=this,t=[...e];e.clear(),t.map(e=>e.redraw())}markDrawContainer(e){var t;this.__containers.add(e),t=this,Yt.add(t),sn()}drawAll(){const e=this.__containers;if(!e.size)return;const t=[...e];e.clear();const n=[];Pe(n),t.forEach(e=>e.drawContainer()),n.forEach(e=>e())}}function an(e,t,n=[]){const r=_(n),o={renderer:e?c(e[Q]):c(),refresh:d,slotRenderFnList:new WeakMap,delivered:Object.create(null),simpleParent:void 0};let s,i=!1,u=!1;function d(){if(!s)return void(i=!0);if(s.destroyed)return;if(i=!0,!s.created)return;if(u)return;let e;for(u=!0;!et(a)&&i;)if(i=!1,e=h(),s.destroyed)return;u=!1,et(a)||e&&s.mounted&&(s.destroyed||s.unmounted||s.setChildren(e))}const a={refresh:d},l=Object.create(null),h=p(e=>e&&d(),()=>wt(o,r.value,l,[],!1,!1));return s=new dn(e,e,t,h()),i&&d(),[s,r]}function ln(e,t={}){const[n,r]=function(e,t){if(void 0===e)return an(null,t);if(ve(e))return an(e,t);if(!be(e))return an(null,t,[Re(e)]);if(ve(e.tag)){const n={...e.props,...t};return an(e.tag,n)}return an(null,t,[e])}(e,t),o=Object.create(n.entity,{update:{configurable:!0,value:e=>(n.destroyed||r(void 0===e?[]:be(e)?[e]:[Re(e)]),o)},mount:{configurable:!0,value:(e,t)=>(n.destroyed||n.mounted||(n.mount({}),n.setmountedRoot(e,t)),o)},unmount:{configurable:!0,value(){if(n.mounted&&!n.unmounted)return n.destroyed||n.destroy(),n.unmount(),o}}});return o}function hn(e,t){return Reflect.defineProperty(e,te,{value:t}),e}function fn(e,t){return t&&"string"==typeof t?(Reflect.defineProperty(e,X,{value:t}),e):e}function pn(e,t){return Reflect.defineProperty(e,ee,{value:t}),e}function _n(e,t){return t&&"object"==typeof t?(Reflect.defineProperty(e,Y,{value:t}),e):e}function yn(){return function e(t){return Ce(e,t)}}function mn(e){const t=yn();return hn(t,"$$$objectType$$$DeliverComponent"),Reflect.defineProperty(t,he,{value:Symbol()}),Reflect.defineProperty(t,fe,{value:e}),t}function vn(e,{name:t,components:n}={}){const r=yn();return hn(r,"$$$objectType$$$RenderComponent"),fn(r,t),pn(r,e),_n(r,n),r}function $n(e,{name:t,renderer:n}={}){const r=yn();return hn(r,"$$$objectType$$$ContainerComponent"),fn(r,t),pn(r,e),"string"!=typeof n&&"object"!=typeof n||Reflect.defineProperty(r,Q,{value:n}),r}function gn(e,{name:t}={}){const n=yn();return hn(n,"$$$objectType$$$ElementComponent"),fn(n,t),pn(n,e),n}function bn(e,{name:t,components:n,render:r,props:o}={}){const s=wn(e,r);return fn(s,t),_n(s,n),Array.isArray(o)&&Reflect.defineProperty(s,Z,{value:[...o]}),s}function wn(e,t){if("function"!=typeof t)return e;const n=me(t)?t:vn(t);return function(t,r){return Re(n,e(t,r))}}function xn(e,{name:t,components:n,render:r,props:o}={}){const s=wn(e,r);return hn(s,"$$$objectType$$$NativeComponentNode"),fn(s,t),_n(s,n),Array.isArray(o)&&Reflect.defineProperty(s,Z,{value:[...o]}),s}function jn(e,{name:t,components:n}={}){const r=e;return hn(r,"$$$objectType$$$SimpleComponent"),fn(r,t),_n(r,n),r}function Rn(e,{name:t}={}){const n=e;return hn(n,"$$$objectType$$$ShellComponent"),fn(n,t),n}function Cn(e,t){const n=_(0);let r=!1;const o=_(void 0);return jn((s,{childNodes:i})=>{const c=o();return c?Re(c,s,...i):(async function(){if(!r&&(r=!0,!n())){n(1);try{const t=await e();if("function"==typeof t)return void o(t);if(!t)return void n(-1);if("function"==typeof t.default)return void o(t.default);n(-1)}catch(e){console.error(e),n(-1)}}}(),t?Re(t,{loading:0===n()}):null)},{name:"Lazy"})}class kn extends qe{get content(){return this.tree}constructor(e,t,r){super(N,N,e,t,r),n(this,"childNodes",void 0),n(this,"__render",void 0),n(this,"__refreshing",!1),n(this,"__needRefresh",!1),n(this,"__delayedRefresh",0),n(this,"_nodes",[]),this.childNodes=t;const o={renderer:this.renderer,refresh:e=>{this.refresh(e)},slotRenderFnList:new WeakMap,delivered:this.delivered,simpleParent:void 0},s=Object.create(null),i=e=>wt(o,function(e){return Array.isArray(e)?e:be(e)?"template"!==e.tag?[e]:e.children:[e]}(e),s,[],!1,!0);this.__render=p(e=>e&&this.refresh(),()=>{const{childNodes:e}=this;if(1!==e.length)return i(e);const[t]=e;return i("function"!=typeof t?e:t())}),this.created=!0,this.refresh()}refresh(e){if("function"==typeof e)try{return this.__delayedRefresh++,e()}finally{this.__delayedRefresh--,this.__delayedRefresh<=0&&this.refresh()}if(this.destroyed)return;if(this.__needRefresh=!0,!this.created)return;if(this.__refreshing)return;let t;for(this.__refreshing=!0;this.__needRefresh&&!et(this);)if(this.__needRefresh=!1,t=this.__render(),this.destroyed)return;this.__refreshing=!1,t&&(this._nodes=Xt(this,t,this._nodes),et(this)||this.mounted&&(this.destroyed||this.unmounted||this.requestDraw()))}_update(e,t){this.childNodes=t,this.refresh()}_destroy(){this.__render.stop(),At(this._nodes)}_mount(e){this.tree=Qe(this.renderer,e,this._nodes)}_redraw(e){this.tree=Qe(this.renderer,e,this._nodes,this.tree)}_unmount(){Be(this.renderer,this.tree)}}function Nn(e,t){switch(t){case"standardComponent":return e instanceof zt;case"renderComponent":return e instanceof Vt;case"component":return e instanceof Ft;case"container":return e instanceof dn;case"deliver":return e instanceof Xe;case"element":return e instanceof St;case"group":return e instanceof Ct;case"shell":return e instanceof Dt;case"value":return e instanceof Rt;case"render":return e instanceof kn;case"slot":return e instanceof Ot;case"node":return e instanceof qe;case"ref":return e instanceof Nt}return e instanceof Me}var Sn=Object.freeze({__proto__:null,install:C,Error:r,render:ln,register:yt,getNode:Oe,createDeliverComponent:mn,createRenderComponent:vn,createContainerComponent:$n,createElementComponent:gn,createStandardComponent:bn,createNativeComponent:xn,createSimpleComponent:jn,createShellComponent:Rn,createComponent:bn,isSimpleComponent:pe,isShellComponent:_e,isNativeComponent:ye,isRenderComponent:me,isContainerComponent:ve,isElementComponent:$e,isDeliverComponent:ge,isDeliver:ge,lazy:Cn,version:"0.1.0-alpha.16",isProduction:!0,ScopeSlot:k,Render:N,Slot:S,Container:D,Template:"template",Fragment:"template",get value(){return _},get computed(){return y},get isValue(){return m},get encase(){return R},get valueify(){return v},get asValue(){return $},get mixValue(){return g},get defineProperty(){return b},ref:O,watch:K,useValue:W,useService:U,byService:G,hook:J,isElement:be,isFragmentElement:we,isRenderElement:xe,isSimpleElement:je,createElement:Re,createElementBase:Ce,createRenderElement:ke,elements:Ne,equal:Se,createTemplateElement:De,label:Te,rendererSymbol:Q,nameSymbol:X,componentsSymbol:Y,propsSymbol:Z,componentValueSymbol:ee,objectTypeSymbol:te,objectTypeSymbolElement:"$$$objectType$$$Element",objectTypeSymbolDeliverComponent:"$$$objectType$$$DeliverComponent",objectTypeSymbolNativeComponent:"$$$objectType$$$NativeComponentNode",objectTypeSymbolSimpleComponent:"$$$objectType$$$SimpleComponent",objectTypeSymbolShellComponent:"$$$objectType$$$ShellComponent",objectTypeSymbolRenderComponent:"$$$objectType$$$RenderComponent",objectTypeSymbolContainerComponent:"$$$objectType$$$ContainerComponent",objectTypeSymbolElementComponent:"$$$objectType$$$ElementComponent",objectTypeSymbolHookEntity:"$$$objectType$$$HookEntity",objectTypeSymbolRootEntity:"$$$objectType$$$RootEntity",deliverKeySymbol:he,deliverDefaultSymbol:fe,setHook:z,callHook:B,get current(){return E},checkCurrent:V,execUseHooks:F,addContextConstructor:ft,addEntityConstructor:Pt,refresh:nt,nextTick:cn,addRendererDraw:un,addRecognizer:Kt,isProxy:Nn});export default Sn;export{D as Container,r as Error,A as Fragment,N as Render,k as ScopeSlot,S as Slot,T as Template,ft as addContextConstructor,Pt as addEntityConstructor,Kt as addRecognizer,un as addRendererDraw,$ as asValue,G as byService,B as callHook,V as checkCurrent,ee as componentValueSymbol,Y as componentsSymbol,y as computed,bn as createComponent,$n as createContainerComponent,mn as createDeliverComponent,Re as createElement,Ce as createElementBase,gn as createElementComponent,xn as createNativeComponent,vn as createRenderComponent,ke as createRenderElement,Rn as createShellComponent,jn as createSimpleComponent,bn as createStandardComponent,De as createTemplateElement,E as current,b as defineProperty,fe as deliverDefaultSymbol,he as deliverKeySymbol,Ne as elements,R as encase,Se as equal,F as execUseHooks,Oe as getNode,J as hook,C as install,ve as isContainerComponent,ge as isDeliver,ge as isDeliverComponent,be as isElement,$e as isElementComponent,we as isFragmentElement,ye as isNativeComponent,t as isProduction,Nn as isProxy,me as isRenderComponent,xe as isRenderElement,_e as isShellComponent,pe as isSimpleComponent,je as isSimpleElement,m as isValue,Te as label,Cn as lazy,g as mixValue,X as nameSymbol,cn as nextTick,te as objectTypeSymbol,ue as objectTypeSymbolContainerComponent,re as objectTypeSymbolDeliverComponent,ne as objectTypeSymbolElement,de as objectTypeSymbolElementComponent,ae as objectTypeSymbolHookEntity,oe as objectTypeSymbolNativeComponent,ce as objectTypeSymbolRenderComponent,le as objectTypeSymbolRootEntity,ie as objectTypeSymbolShellComponent,se as objectTypeSymbolSimpleComponent,Z as propsSymbol,O as ref,nt as refresh,yt as register,ln as render,Q as rendererSymbol,z as setHook,U as useService,W as useValue,_ as value,v as valueify,e as version,K as watch};
